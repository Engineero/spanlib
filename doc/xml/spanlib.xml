<?xml version="1.0"?>
<!DOCTYPE article PUBLIC "-//KDE//DTD DocBook XML V4.2-Based Variant V1.1//EN" "/usr/share/sgml/docbook/xml-dtd-4.2-1.0-17.2/docbookx.dtd">

<article id="index">

	<artheader>
		<title>SpanLib - Spectral Analysis Library</title>
		<authorgroup>
			<author><firstname>Stephane</firstname> <surname>Raynaud</surname></author>
			<author><firstname>Charles</firstname> <surname>Doutriaux</surname></author>
		</authorgroup>
		<keywordset>
			<keyword>statistics</keyword>
			<keyword>physics</keyword>
			<keyword>climate variability</keyword>
			<keyword>financial variability</keyword>
			<keyword>FFT</keyword>
			<keyword>eigen problem</keyword>
			<keyword>spatio-temporal</keyword>
			<keyword>MSSA</keyword>
			<keyword>PCA</keyword>
			<keyword>EOF</keyword>
			<keyword>POP</keyword>
		</keywordset>
	</artheader>

	<articleinfo>
		<address>
			<affiliation>LSCE, Laboratoire CEA-CNRS-UVSQ</affiliation>
			<street>BÃ¢t. 712, Orme des Merisiers</street>
			<postcode>91300</postcode>
			<city>GIF-SUR-YVETTE CEDEX</city>
			<country>France</country>
		</address>
	</articleinfo>

	<!--#################################################################-->
	<!--#################################################################-->
	<abstract>
		yo abstract
	</abstract>

	<!--#################################################################-->
	<!--#################################################################-->
	<sect1 id="doc_int">
		<title>Introduction</title>
		<para class='red'>
			This package provides a F90 module containing a minmal collection of subroutines to perform
			<emphasis>Principal Componant Analysis</emphasis> (PCA),
			<emphasis>Multi-channel Singular Spectrum Analysis</emphasis> (MSSA), reconstruction
			of components and phase composites.
		</para>
		<para>
			<emphasis>PCA</emphasis> is also know as Empirical Orthogonal Functions (EOFs) decomposition:
			it decomposes a space-time signal in pairs of spatial EOFs and temporal PCs
			that are the eigen solutions of the covariance (or correlation) matrix of the initial signal.
		</para>
		<para>
			<emphasis>MSSA</emphasis> works in the same way except that EOF are spatio-temporal, and that the diagonalized
			matrix is built not only using covariances (or correlations) between spatial points,
			but also lag covariances.
			Therefore, MSSA is particularly efficient to remove white noise, and extract oscillations and nonlinear
			trends, even on short samples.
			It uses a window parameter that corresponds to the maximal lag for correlations.
			Oscillations with a period lower than this window can be typically extracted by MSSA.
		</para>

		<para>
			The package also provides the possibility to <emphasis>reconstruct part of the signal</emphasis>
			due to selected modes, for both PCA and MSSA.
			Finally, <emphasis>oscillations</emphasis> extracted by MSSA and reconstructed can be reorganized
			in <emphasis>phases composites</emphasis>: the oscillations are presented over their averaged cycle,
			decomposed in a fixed number of phases
			(like one can do for the annual cycle over 12 months for example).
		</para>

		<para>
			More information about PCA and MSSA may be found in papers and on the web.
			See for example:
			<itemizedlist>
				<listitem>MSSA: <link linkend="#plva94">Plaut and Vautard, 1994</link>.</listitem>
			</itemizedlist>
		</para>

		<para>
			An html version of the source code is available here:
			<filename><ulink url="code_lib_f90.html">spanlib.f90</ulink></filename>.
		</para>
	</sect1>

	<!--#################################################################-->
	<!--#################################################################-->
	<sect1 id="doc_ins">
		<title>Installation</title>

		<sect2 id="doc_ins_req">
			<title>Requirements</title>
			<sect3>
				<title>Fortran library</title>
				<para>You need a F90 compiler and BLAS/LAPACK  libraries compilated using this F90 compiler.</para>
				<para>To run the example, you need the F90 netcdf library.</para>
			</sect3>
			<sect3>
				<title>Python module</title>
				<para>You need the fortran library, and the pyfort module.</para>
			</sect3>
		</sect2>

		<sect2 id="doc_ins_dow">
			<title>Download</title>
		</sect2>

		<sect2 id="doc_ins_ins">
			<title>Installation</title>
			<procedure>
				<step>
					<para>
						First, compile it with:
<!---->
<screen>
<prompt>user$</prompt> <userinput>./configure</userinput>
<prompt>user$</prompt> <userinput>make
</userinput>
</screen>
					</para>
				</step>
				<step>
					<para>
						Second, install it as root:
<screen>
<prompt>user$</prompt> <userinput>su</userinput>
<prompt>root$</prompt> <userinput>make install
</userinput>
</screen>.
<!---->
					</para>
				</step>
			</procedure>
		</sect2>

	</sect1>

	<!--#################################################################-->
	<!--#################################################################-->
	<sect1 id="doc_f90">
		<title>The Fortran 90 library</title>

		<!--#################################################################-->
		<sect2 id="doc_f90_int">
			<title>Introduction</title>

		</sect2>

		<!--#################################################################-->
		<xi:include href="doc_f90_sub_inc.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />

		<!--#################################################################-->
		<sect2 id="doc_f90_exa">
			<title>A Fortran 90 example</title>
			<para>
				This is an example of how to use this the Fortran 90 component of Spanlib.
				In this example, an analysis of Sea surface Temperature anomalies using data
				stored in the netcdf format.
				The dominant oscillatory mode of the El Nino variability is then extracted
				and stored in a netcdf file.
			</para>
			<example>
				<title>F90 example</title>
				<xi:include href="src_f90_exa_inc.xml"  xmlns:xi="http://www.w3.org/2001/XInclude" />
			</example>
		</sect2>

	</sect1>

	<!--#################################################################-->
	<!--#################################################################-->
	<sect1 id="doc_pyt">
		<title>The python module</title>

		<!--#################################################################-->
		<sect2 id="doc_pyt_int">
			<title>Introduction</title>
		</sect2>

		<!--#################################################################-->
		<xi:include href="doc_pyt_sub_inc.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />

		<!--#################################################################-->
		<sect2 id="doc_pyt_exa">
			<title>A python example</title>
			<example>
				<title>Python example</title>
				<para>This is a wonderful python example</para>
				<example>
					<title>Python example</title>
					<xi:include href="src_pyt_exa_inc.xml"  xmlns:xi="http://www.w3.org/2001/XInclude" />
				</example>
			</example>
		</sect2>
	</sect1>

	<!--#################################################################-->
	<sect1 id="doc_ref">
		<title>References</title>
		<itemizedlist>
			<listitem>MSSA: <anchor id="#plva94" />Plaut and Vautard, 1994.</listitem>
		</itemizedlist>
	</sect1>

	<!--#################################################################-->
	<bibliography id="doc_bib">

		<!-- Normal -->
		<biblioentry>
			<abbrev>AhoSethiUllman96</abbrev>
			<authorgroup>
			<author>
					<firstname>Alfred V.</firstname><surname>Aho</surname>
				</author>
			<author>
					<firstname>Ravi</firstname><surname>Sethi</surname>
				</author>
		</authorgroup>
		<year>3020</year>
		<copyright><year>1996</year>
			<holder>Bell Telephone Laboratories, Inc.</holder></copyright>
		<editor>
				<firstname>James T.</firstname><surname>DeWolf</surname>
			</editor>
		<publisher>
			<publishername>Addison-Wesley Publishing Company</publishername>
		</publisher>
		<title>Compilers, Principles, Techniques, and Tools</title>

		</biblioentry>

		<!-- Mixed -->
		<bibliomixed>
			<bibliomset relation='article'>Walsh, Norman.
				<title role='article'>Introduction to Cascading Style Sheets</title>.
			</bibliomset>
			<bibliomset relation='journal'>
				<title>The World Wide Web Journal</title>
				<volumenum>2</volumenum><issuenum>1</issuenum>.
				<publishername>O'Reilly &amp; Associates, Inc.</publishername> and
				The World Wide Web Consortium. Winter, 1996
			</bibliomset>.
		</bibliomixed>

	</bibliography>




</article>