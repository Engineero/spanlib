<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>SpanLib - Spectral Analysis Library</title>
    <link rel="stylesheet" href="spanlib.css" type="text/css"/>
    <meta name="generator" content="DocBook XSL Stylesheets V1.61.2"/>
    <meta name="keywords" content="statistics, physics, climate variability, financial variability, FFT, eigen problem, spatio-temporal, MSSA, PCA, EOF, POP"/>
    <meta xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:date="http://exslt.org/dates-and-times" name="date" content="2006-09-05+02:00 19:16:00+02:00"/>
    <link rel="home" href="index.html" title="SpanLib - Spectral Analysis Library"/>
    <link rel="next" href="doc_ins.html" title="2. Installation"/>
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">SpanLib - Spectral Analysis Library</th>
        </tr>
        <tr>
          <td width="20%" align="left"> </td>
          <th width="60%" align="center"> </th>
          <td width="20%" align="right"> <a accesskey="n" href="doc_ins.html">Next</a></td>
        </tr>
      </table>
      <hr/>
    </div>
    <div class="article" lang="en" id="index">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="id3326028"/>SpanLib - Spectral Analysis Library</h1>
          </div>
          <div>
            <div class="authorgroup">
              <div class="author">
                <h3 class="author"><span class="firstname">Stephane</span> <span class="surname">Raynaud</span></h3>
              </div>
              <div class="author">
                <h3 class="author"><span class="firstname">Charles</span> <span class="surname">Doutriaux</span></h3>
              </div>
              <div class="affiliation">
                <div class="address">
                  <p>Contact: <tt class="email">&lt;<a href="mailto:stephane.raynaud at gmail.com">stephane.raynaud at gmail.com</a>&gt;</tt><br/>
				</p>
                </div>
              </div>
            </div>
          </div>
          <div>
            <p class="releaseinfo">
			</p>
            <p>Version 1.0</p>
            <p class="releaseinfo">
			</p>
            <p>
				Project hosted by:
				<a href="http://sourceforge.net" target="_top">
					<div><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="88"><tr><td><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=168272&amp;type=1" width="88"/></td></tr></table></div>
				</a>
			</p>
            <p class="releaseinfo">
		</p>
          </div>
          <div>
            <fo:block xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:date="http://exslt.org/dates-and-times">This documentation was generated on 5 September 2006</fo:block>
          </div>
        </div>
        <div/>
        <hr/>
      </div>
      <div class="sect1" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a id="doc_pre"/>1. Presentation</h2>
            </div>
          </div>
          <div/>
        </div>
        <div class="sect2" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="doc_pre_int"/>1.1. Introduction</h3>
              </div>
            </div>
            <div/>
          </div>
          <p>
				Observed or simulated multi-channel timeseries generally include
				a sum of different signals that can be hardly distinguished one another,
				even if their respective origin is fundamentally different.
				Analysis methods that are able to extract the most coherent modes
				of variability generally helps to identify signals of interests.
			</p>
          <p>
				SpanLib currently focuses on the use of linear analysis methods
				that rely on eign solutions of covariance or correlations matrices
			</p>
          <p>
				This package provides a <a href="doc_f90.html" title="3. The Fortran 90 library">F90 library</a> (as a module)
				containing a minimal collection of subroutines to perform
				<span class="bold"><b>Principal Componant Analysis</b></span> (PCA),
				<span class="bold"><b>Multi-channel Singular Spectrum Analysis</b></span> (MSSA), reconstruction
				of components and phase composites.
				The package also provide a <a href="doc_pyt.html" title="4. The python module">python module</a>
				that calls the F90 library and gives the user a set of useful functions
				to perform analyses.
			</p>
          <p>
				In its future version, SpanLib will also include others methods, such
				Singular Value Decomposition or Principal Oscillation Pattern analysis.
			</p>
        </div>
        <div class="sect2" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="doc_pre_fun"/>1.2. Fundamentals</h3>
              </div>
            </div>
            <div/>
          </div>
          <p>
				<span class="bold"><b><a href="index.html#pca">PCA</a></b></span> is also know as Empirical Orthogonal Functions (EOFs) decomposition:
				it decomposes a space-time signal in pairs of
				spatial EOFs and temporal
				Principal Components (PCs)
				that are the eigen solutions of the covariance (or correlation) matrix of the initial signal.
				The first EOFs represent the dominant, pure spatial patterns of variability,
				and their associated PCs are the coefficients that regulate these patterns.
				</p>
          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
					In this document, &quot;space&quot; refers to the more general notion
					of &quot;channel&quot;,  in opposition to &quot;time&quot;.
					In climate studies, the channel dimension generally coincides with space.
				</div>
          <p>
			</p>
          <p>
				<span class="bold"><b><a href="index.html#ssa">SSA</a></b></span> (Singular Spectrum Analysis)
				is mathematically very similar to PCA:
				there is now only one channel as an input dataset, and eigenmodes are computed on
				the lag-covariance matrix (instead of on the cross -between channels- covriance matrix).
				The EOFs have only a temporal dimension.
				Therefore, SSA is intended to provides information on purely temporal signal, like
				a classical Fourier decomposition.
				However, SSA has many advantages on the latter method:
				</p>
          <div class="itemizedlist">
            <ul type="disc">
              <li>
						It removes <span class="emphasis"><em>incoherent noise</em></span> (white noise):
						the noisy part of the signal takes the form of low order
						modes, identified as a &quot;background&quot; that can be easily neglected.
					</li>
              <li>
						It naturally extracts <span class="emphasis"><em>regular oscillations</em></span> (with a narrow spectral peak).
						These oscillations are identified as pair of modes whose PCs and EOFs
						are in phase quadrature, that can be <span class="emphasis"><em>intermittent</em></span>.
					</li>
              <li>
						Coherent nonlinear trends are identified as the lower frequency modes.
					</li>
              <li>
						Compared to others, this method is efficient on short signal.
					</li>
            </ul>
          </div>
          <p>
				The maximal lag (the only parameter of SSA) is known as the
				<a href="index.html#window" title="The window parameter">window</a>.
			</p>
          <p>
				<span class="bold"><b><a href="index.html#mssa">MSSA</a></b></span>
				is a combination of PCA and SSA: it is an SSA on several channels.
				The diagonalized is built on covariances between channels (cross) and time segments (lag).
				Therefore, it has the advantage of PCA for extracting the dominant &quot;spatial&quot; patterns
				of the variability, and has also the spectral filtering capabilities of SSA.
				All identified modes have spatio-temporal properties.
				For example, oscillations are not constrained on a fixed spatial pattern, but can also
				have a <span class="emphasis"><em>propagative signature</em></span> over their cycle.
				<span class="emphasis"><em>This advanced spatial and spectral filtering is helpful to identify
				the most coherent (and more espacially oscillatory) spatio-temporal modes in a short
				noisy signal.</em></span>
			</p>
          <p>
				All these analysis methods act as a linear filter.
				For each of them, it is possible to reconstruct part of the filtered signal.
				A reconstructed mode is the &quot;multiplication&quot; of its EOF by its PC, and
				it has the same dimension of the initial dataset.
				Such operation is necessary to go back from the EOF space to the physical space.
			</p>
          <p><a id="pg:dof"/>
				Finally, PCA may be used also to simply reduce the number of degree-of-freedom (d-o-f) of a dataset.
				For example, you can keep the first PC that explain a 80% of the variance.
				These PCs are then used as an input dataset for other analysis.
				This methodology is useful for MSSA since the eigen problem solving
				may be very time consuming: we are now able, for example, to potentially reduce the
				number of channels from several hundred or thounsand, to less than 20.
			</p>
        </div>
        <div class="sect2" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="doc_pre_tec"/>1.3. Some technical details...</h3>
              </div>
            </div>
            <div/>
          </div>
          <div class="sect3" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="doc_pre_tec_pca"/>1.3.1. ...about PCA</h4>
                </div>
              </div>
              <div/>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="id3261732"/>CPU: space versus time</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						PCA decomposition is performed on spatio-temporal datasets.
						If the number of channels becomes important, PCA can use a lot of CPU since
						the size of the diagonalised matrix if to the square of this number.
						It is possible to partly avoid this problem when the time dimension is lower
						than the spatial dimension, using a correlation matrix
						in time instead of in space.
						F90 subroutine <tt class="varname"><a href="doc_f90_sub.html#sl_pca" title="3.2.1. Principal Component Analysis: sl_pca">sl_pca</a></tt> of SpanLib
						provides the ability
						to choose which of theses approaches to use for PCA.
					</p>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="id3261764"/>Weights</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						In some case, not all channels have the same weight.
						For instance, for gridded dataset, weight must be proportional
						to the grid cell area.
						Whereas common PCA analysis does not take these weights into account
						it is possible to give optional weights to
						<tt class="varname"><a href="doc_f90_sub.html#sl_pca" title="3.2.1. Principal Component Analysis: sl_pca">sl_pca</a></tt>.
						Using the <a href="doc_pyt.html" title="4. The python module">python module</a>,
						it is easy to &quot;attach&quot; weights to a variable for use by
						<tt class="varname"><a href="doc_pyt_sub.html#&lt;SpAn_object&gt;.pca" title="4.2.6.  Principal Components Analysis (PCA): &lt;SpAn_object&gt;.pca">pca</a></tt>.
					</p>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="id3261812"/>Mask</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						Similarly, it is not useful to analyse masked points
						(for example, gridded points situated on land when use analyse oceanic data).
						The F90 subroutine <tt class="varname"><a href="doc_f90_sub.html#sl_pca" title="3.2.1. Principal Component Analysis: sl_pca">sl_pca</a></tt>
						makes the supposition that none of the masked (all channels are analysed).
						However, as well as for the weights, it is possible to associate
						an spatial mask to a dataset in order to remove masked points when
						using the python module.
						Then, <tt class="varname"><a href="doc_pyt_sub.html#spanlib.pack" title="4.2.3.  Computes weights and mask: spanlib.pack">spanlib.pack</a></tt>
						can be used to &quot;pack&quot; (compress) data before they are analysed.
					</p>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="id3261853"/>Analysing several variables at the same time</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						One can be interested in analysing several variables ate the same time.
						These variables may come from different regions, datasets and may be
						even of completely different nature.
						The essential problem of units may be solved using simple
						normalisations.
						Python function <tt class="varname"><a href="doc_pyt_sub.html#spanlib.stackData" title="4.2.1.  Takes several data files, of same time and stacks them up together: spanlib.stackData">spanlib.stackData</a></tt>
						can be used to &quot;pack&quot; (compress) data before they are analysed.
						Then, using <tt class="varname"><a href="doc_pyt_sub.html#spanlib.unStackData" title="4.2.2.  Unstack data in the form returned from stackData: spanlib.unStackData">spanlib.unStackData</a></tt>
						you can unpack results from you analysis.
						<a href="doc_bib.html#raynal06">Raynaud et al (2006)</a> presents an example of use where variables
						such as sea surface temperature, wind stress modulus and air-sea CO2
						fluxes are analysed at the same time:
						the simultaneous variability of the variables is filtered and
						the dominant oscillations are extracted for each of these variables.
					</p>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="id3261909"/>Reconstructions</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						Reconstructions (F90:<tt class="varname"><a href="doc_f90_sub.html#sl_pcarec" title="3.2.2. Reconstruction of a set of PCA components: sl_pcarec">sl_pcarec</a></tt>,
						Python:<tt class="varname"><a href="doc_pyt_sub.html#&lt;SpAn_object&gt;.reconstruct" title="4.2.8.  Reconstruct results from mssa or pca: &lt;SpAn_object&gt;.reconstruct">&lt;SpAn_object&gt;.reconstruct</a></tt>)
						may not be necessary the multiplication of an EOF by its associated PC.
						When PCA is used for a reduction of d-o-f (see <a href="index.html#pg:dof">Section 1.2, &#8220;Fundamentals&#8221;</a>),
						orginal PCs are first filtered and then converted back to the original space
						using saved EOFs.
					</p>
            </div>
          </div>
          <div class="sect3" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="doc_pre_tec_msa"/>1.3.2. ...about MSSA</h4>
                </div>
              </div>
              <div/>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="window"/>The window parameter</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						This is the only and essential parameter of SSA and MSSA
						(F90:<tt class="varname"><a href="doc_f90_sub.html#sl_pcarec" title="3.2.2. Reconstruction of a set of PCA components: sl_pcarec">sl_mssa</a></tt>,
						Python:<tt class="varname"><a href="doc_pyt_sub.html#&lt;SpAn_object&gt;.mssa" title="4.2.7.  MultiChannel Singular Spectrum Analysis (MSSA): &lt;SpAn_object&gt;.mssa">&lt;SpAn_object&gt;.mssa</a></tt>).
						It defines the maximal value of the lags use when building
						the covariance matrix.
						It acts as a spectral parameter: the spectral resolution
						is higher for periods lower than this period.
						A standard value is one third of the time dimension.
					</p>
            </div>
            <div class="simplesect" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h5 class="title"><a id="id3311067"/>Phase composites</h5>
                  </div>
                </div>
                <div/>
              </div>
              <p>
						One of the most important interests of MSSA is to be able to
						extract intermittent space-time oscillations from the signal.
						At the first order, an oscillation is its &quot;typical&quot; cycle.
						<tt class="varname"><a href="doc_f90_sub.html#sl_phasecomp" title="3.2.5. Phase composites: sl_phasecomp">sl_phasecomp</a></tt> (F90)
						and
						<tt class="varname"><a href="">spanlib.phases</a></tt> (Python)
						perfom phases composites: it computes an averaged cycle and cut it an
						homegeneous parts (as one can do for the annual cycle in 12 months).
					</p>
            </div>
          </div>
        </div>
        <div class="sect2" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="doc_pre_mor"/>1.4. For more information</h3>
              </div>
            </div>
            <div/>
          </div>
          <p>
				For more information about PCA and MSSA may be found in papers and on the web.
				See for example:
				</p>
          <div class="itemizedlist">
            <ul type="disc">
              <li><span class="bold"><a id="pca"/><b>PCA: </b></span><a href="doc_bib.html#prei88">Preisendorfer (1988)</a>,
						<a href="doc_bib.html#wilk95">Wilks (1995)</a>.
					</li>
              <li><span class="bold"><a id="ssa"/><b>SSA: </b></span><a href="doc_bib.html#brki86">Broomhead and King (1986)</a>,
						<a href="doc_bib.html#vagh89">Vautard and Ghil (1989)</a>.
					</li>
              <li><span class="bold"><a id="mssa"/><b>MSSA: </b></span><a href="doc_bib.html#plva94">Plaut and Vautard (1994)</a>,
						<a href="doc_bib.html#raynal05">Raynaud et al (2005)</a>,
						<a href="doc_bib.html#raynal06">Raynaud et al (2006)</a>.
					</li>
            </ul>
          </div>
          <p>
				You can also browse <a href="doc_lin.html" title="5. Links">Section 5, &#8220;Links&#8221;</a>.
			</p>
        </div>
        <div class="sect2" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="doc_int_vie"/>1.5. View sources</h3>
              </div>
            </div>
            <div/>
          </div>
          <p>
				An html version of the source codes is available here:
				</p>
          <div class="itemizedlist">
            <ul type="disc">
              <li><tt class="filename"><a href="src_f90_lib.html" target="_top">spanlib.f90</a></tt>
						for the <a href="doc_f90.html" title="3. The Fortran 90 library">fortran library</a>,
					</li>
              <li><tt class="filename"><a href="src_pyt_mod.html" target="_top">spanlib_python.py</a></tt>
						for the <a href="doc_pyt.html" title="4. The python module">python module</a>.
					</li>
            </ul>
          </div>
          <p>
			</p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr/>
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"> </td>
          <td width="20%" align="center"> </td>
          <td width="40%" align="right"> <a accesskey="n" href="doc_ins.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top"> </td>
          <td width="20%" align="center"> <a accesskey="t" href="index.html-toc.html">ToC</a></td>
          <td width="40%" align="right" valign="top"> 2. Installation</td>
        </tr>
      </table>
    </div>
    <HR xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:date="http://exslt.org/dates-and-times"/>
    <div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:date="http://exslt.org/dates-and-times" class="generated"><a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=168272&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>
			This document was generated using xsltproc and perl.
		</div>
  </body>
</html>
