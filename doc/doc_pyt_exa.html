<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>4.3. Python examples</title>
    <link rel="stylesheet" href="spanlib.css" type="text/css"/>
    <meta name="generator" content="DocBook XSL Stylesheets V1.61.2"/>
    <meta name="keywords" content="statistics, physics, climate variability, financial variability, FFT, eigen problem, spatio-temporal, MSSA, Multichannel singular spectrum analysis, PCA, Principal component analysis, EOF, Empirical othogonal funtion, PC, Principal component, SVD, Singular value decomposition, POP, Principal oscillation patterns"/>
    <link rel="home" href="index.html" title="SpanLib - Spectral Analysis Library"/>
    <link rel="up" href="doc_pyt.html" title="4. The python module"/>
    <link rel="previous" href="doc_pyt_sub.html" title="4.2. Python functions"/>
    <link rel="next" href="doc_lin.html" title="5. Links"/>
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">4.3. Python examples</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="doc_pyt_sub.html">Prev</a> </td>
          <th width="60%" align="center">4. The python module</th>
          <td width="20%" align="right"> <a accesskey="n" href="doc_lin.html">Next</a></td>
        </tr>
      </table>
      <hr/>
    </div>
    <div class="sect2" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title"><a id="doc_pyt_exa"/>4.3. Python examples</h3>
          </div>
        </div>
        <div/>
      </div>
      <p>
				These examples show how to use some of the available
				components of the python module.
				They uses the same dataset as for <a href="doc_f90_exa.html" title="3.3. Fortran 90 examples">Section 3.3, &#8220;Fortran 90 examples&#8221;</a>.
			</p>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
				You can run depending on your configuration, and
				you must have previously performed a <pre class="programlisting"><tt class="prompt">&lt;user&gt;</tt> <b class="userinput"><tt>make install</tt></b></pre></div>
      <div class="sect3" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title"><a id="doc_pyt_ex1"/>4.3.1. Python example 1</h4>
            </div>
          </div>
          <div/>
        </div>
        <p>
					This first example is similar to <a href="doc_f90_exa.html" title="3.3. Fortran 90 examples">Section 3.3, &#8220;Fortran 90 examples&#8221;</a>:
					a PCA/MSSA is performed on the whole dataset,
					and the first oscillation (pair of MSSA modes) is
				reconstructed using phases composites (16 phases).
				</p>
        <div class="example">
          <a id="id3017240"/>
          <p class="title">
            <b>Example 3. Python example 1</b>
          </p>
          <p>
						Run this example using:
						</p>
          <pre class="programlisting"><tt class="prompt">&lt;user&gt;</tt> <b class="userinput"><tt>make python1</tt></b></pre>
          <p>
							</p>
          <pre class="programlisting"><span class="HLcomments"># File: example2.py</span>
<span class="HLcomments">#</span>
<span class="HLcomments"># This file is part of the SpanLib library.</span>
<span class="HLcomments"># Copyright (C) 2006  Charles Doutiraux, Stephane Raynaud</span>
<span class="HLcomments"># Contact: stephane dot raynaud at gmail dot com</span>
<span class="HLcomments">#</span>
<span class="HLcomments"># This library is free software; you can redistribute it and/or</span>
<span class="HLcomments"># modify it under the terms of the GNU Lesser General Public</span>
<span class="HLcomments"># License as published by the Free Software Foundation; either</span>
<span class="HLcomments"># version 2.1 of the License, or (at your option) any later version.</span>
<span class="HLcomments">#</span>
<span class="HLcomments"># This library is distributed in the hope that it will be useful,</span>
<span class="HLcomments"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="HLcomments"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="HLcomments"># Lesser General Public License for more details.</span>
<span class="HLcomments">#</span>
<span class="HLcomments"># You should have received a copy of the GNU Lesser General Public</span>
<span class="HLcomments"># License along with this library; if not, write to the Free Software</span>
<span class="HLcomments"># Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span>


<span class="HLcomments">###################################################################</span>
<span class="HLcomments"># In this example, we analyse two different areas at the same time.</span>
<span class="HLcomments"># You can do the same with two completely different datasets,</span>
<span class="HLcomments"># except that they must have the same temporal grid.</span>
<span class="HLcomments">###################################################################</span>
<span class="HLcommands">print</span> &quot;<span class="HLcomments">##############################################&quot;</span>
<span class="HLcommands">print</span> &quot;<span class="HLcomments"># PCA+MSSA applied on two different regions. #&quot;</span>
<span class="HLcommands">print</span> &quot;<span class="HLcomments"># Then reconstructions and plots.            #&quot;</span>
<span class="HLcommands">print</span> &quot;<span class="HLcomments">##############################################&quot;</span>

<span class="HLcomments"># Needed modules</span>
<span class="HLcommands">import</span> cdms
<span class="HLcommands">import</span> spanlib
<span class="HLcommands">import</span> MV
<span class="HLcommands">import</span> vcs

<span class="HLcomments"># We tell cdms that we have longitude, latitude and time</span>
cdms.axis.latitude_aliases.append(<span class="HLstrings">'Y'</span>)
cdms.axis.longitude_aliases.append(<span class="HLstrings">'X'</span>)
cdms.axis.time_aliases.append(<span class="HLstrings">'T'</span>)

<span class="HLcomments"># Simply open the netcdf file</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;<span class="HLfunctions">Open</span> file&quot;</span>
f=cdms.<span class="HLfunctions">open</span>(<span class="HLstrings">'data2.cdf'</span>)

<span class="HLcomments"># Get our two datasets</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;Read two different regions&quot;</span>
s2=f(<span class="HLstrings">'ssta'</span>,latitude=(-<span class="HLdigits">10</span>,<span class="HLdigits">10</span>),longitude=(<span class="HLdigits">110</span>,<span class="HLdigits">180</span>))
s1=f(<span class="HLstrings">'ssta'</span>,latitude=(-<span class="HLdigits">15</span>,<span class="HLdigits">15</span>),longitude=(<span class="HLdigits">210</span>,<span class="HLdigits">250</span>))

<span class="HLcomments"># Stack the two dataset to have only one dataset</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;Stacking data&quot;</span>
res = spanlib.<span class="HLpersonalised">stackData</span>(s1,s2)

<span class="HLcomments"># Create the analysis object</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;Creating <span class="HLpersonalised">SpAn</span> object&quot;</span>
SP=spanlib.<span class="HLpersonalised">SpAn</span>(MV.array(res[<span class="HLdigits">0</span>]),weights=MV.array(res[<span class="HLdigits">1</span>]))

<span class="HLcomments"># Perform a preliminary PCA</span>
<span class="HLcomments"># (optional step since done by default with mssa)</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;<span class="HLpersonalised">PCA</span>+<span class="HLpersonalised">MSSA</span>...&quot;</span>
steof,stpc,stev = SP.<span class="HLpersonalised">mssa</span>(<span class="HLpersonalised">pca</span>=<span class="HLspecial">True</span>)

<span class="HLcomments"># Recontructed the filtered field</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;Reconstructing selected modes&quot;</span>
ffrec = SP.<span class="HLpersonalised">reconstruct</span>()

<span class="HLcomments"># Unstacking</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;Unstaking data&quot;</span>
out = spanlib.<span class="HLpersonalised">unStackData</span>(ffrec,res[<span class="HLdigits">1</span>],res[<span class="HLdigits">2</span>],res[<span class="HLdigits">3</span>])

<span class="HLcomments"># Plot a timeseries taken from our two</span>
<span class="HLcomments"># recontructed datasets</span>
<span class="HLcommands">print</span> <span class="HLstrings">&quot;Time series <span class="HLcommands">for</span> the two filtered regions&quot;</span>
x=vcs.init()
x.plot(out[<span class="HLdigits">1</span>][:,<span class="HLdigits">5</span>,<span class="HLdigits">5</span>])
x.plot(out[<span class="HLdigits">0</span>][:,<span class="HLdigits">5</span>,<span class="HLdigits">5</span>])
<span class="HLfunctions">raw_input</span>(<span class="HLstrings">'ok?'</span>)
</pre>
        </div>
      </div>
      <div class="sect3" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title"><a id="doc_pyt_ex2"/>4.3.2. Python example 2</h4>
            </div>
          </div>
          <div/>
        </div>
        <p>
					In this second example, two different areas are analysed at
					the same time.
					This is intented to mimics the used of two different datasets
					that are stacked, before being analysed.
					Such approach (see for example <a href="doc_bib.html#raynal06">Raynaud et al (2006)</a>) allows
					to find modes of variability in a arbitrary number of variables,
					provided you are careful with units (performing appropriate normalisations).
				</p>
      </div>
      <div class="example">
        <a id="id3072261"/>
        <p class="title">
          <b>Example 4. Python example 2</b>
        </p>
        <p>
					Run this example using:
					</p>
        <pre class="programlisting"><tt class="prompt">&lt;user&gt;</tt> <b class="userinput"><tt>make python2</tt></b></pre>
        <p>
				</p>
        <pre class="programlisting"/>
      </div>
    </div>
    <div class="navfooter">
      <hr/>
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="doc_pyt_sub.html">Prev</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="doc_pyt.html">Up</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="doc_lin.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">4.2. Python functions </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Home</a>
          </td>
          <td width="40%" align="right" valign="top"> 5. Links</td>
        </tr>
      </table>
    </div>
    <a xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" href="http://sourceforge.net">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=168272&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/>
    </a>
    <div xmlns="" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="generated">This document was generated using xsltproc and perl.</div>
  </body>
</html>
