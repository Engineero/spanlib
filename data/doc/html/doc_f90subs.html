<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>2. F90 subroutines</title><link rel="stylesheet" href="spanlib.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.61.2"/><meta name="keywords" content="statistics, physics, climate variability, FFT, wavelets, spatio-temporal, MSSA, PCA, EOF, POP"/><link rel="home" href="index.html" title="SpanLib - Spectral Analysis Library"/><link rel="up" href="index.html" title="SpanLib - Spectral Analysis Library"/><link rel="previous" href="index.html" title="SpanLib - Spectral Analysis Library"/><link rel="next" href="doc_examples.html" title="3. Examples"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2. F90 subroutines</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="index.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="doc_examples.html">Next</a></td></tr></table><hr/></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="doc_f90subs"/>2. F90 subroutines</h2></div></div><div/></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sl_pca"/>2.1. Principal Component Analysis: <tt class="literal">sl_pca</tt></h3></div></div><div/></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3191308"/>Usage</h4></div></div><div/></div><table bgcolor="" width="100%" align="center" border="0"><tr><td><pre class="programlisting">call <span class="b">sl_pca</span>(<span class="b">ff</span>, nkeep=<span class="b">nkeep</span>, xeof=<span class="b">xeof</span>, pc=<span class="b">pc</span>, ev=<span class="b">ev</span>, weights=<span class="b">weights</span>, useteof=<span class="b">useteof</span>)</pre></td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3191374"/>Description</h4></div></div><div/></div><p>
Perform a decomposition of space-time field in a set of
Empirical Orthogonal Functions (EOFs) and Principal components (PCs).
The input data set can be optionally weighted in space.
By default, the analysis computes  &quot;temporal&quot; (T) or classical
spatial (S) EOFs depending on if the space dimension is greater
than the time dimension. This default behavior can be overridden.
		</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3191393"/>Necessary arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">ff</tt></td><td class="s">[input,real]:</td><td>			Space-time array</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3191478"/>Optional arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">nkeep</tt></td><td class="s">[input,integer]:</td><td>		Maximum number of modes to keep in outputs</td></tr><tr><td class="b"><tt class="varname">xeof</tt></td><td class="s">[output,real]:</td><td>		Space-mode array of EOFs</td></tr><tr><td class="b"><tt class="varname">pc</tt></td><td class="s">[output,real]:</td><td>			Time-mode array of PCs</td></tr><tr><td class="b"><tt class="varname">ev</tt></td><td class="s">[output,real]:</td><td>			Mode array of eigen values (variances)</td></tr><tr><td class="b"><tt class="varname">weights</tt></td><td class="s">[input,real]:</td><td>	Space array of weights</td></tr><tr><td class="b"><tt class="varname">useteof</tt></td><td class="s">[input,integer]:</td><td>	To force the use of T or S EOFs [0 = T, 1 = S, -1 = default]</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3186281"/>Dependencies</h4></div></div><div/></div><p>
			<span class="b"><tt class="literal"><a href="doc_f90subs.html#sl_diasym" title="2.6. Diagonalisation of a symetric matrix: sl_diasym">sl_diasym</a></tt></span>
		</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sl_pcarec"/>2.2. Reconstruction of a set of PCA components: <tt class="literal">sl_pcarec</tt></h3></div></div><div/></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3186323"/>Usage</h4></div></div><div/></div><table bgcolor="" width="100%" align="center" border="0"><tr><td><pre class="programlisting">call <span class="b">sl_pcarec</span>(<span class="b">xeof</span>, <span class="b">pc</span>, <span class="b">ffrec</span>, istart=<span class="b">istart</span>, iend=<span class="b">iend</span>)</pre></td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3186376"/>Description</h4></div></div><div/></div><p>
Perform a reconstruction using a set of components previously
computed with a PCA. All the reconstructed components are summed.
A reconstructed component is simply the &quot;product&quot; of an EOF
by its PC. The sum of all reconstructed component is the original field.
		</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3186394"/>Necessary arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">xeof</tt></td><td class="s">[input,real]:</td><td>	Space-mode array of EOFs</td></tr><tr><td class="b"><tt class="varname">pc</tt></td><td class="s">[input,real]:</td><td>		Time-mode array of PCs</td></tr><tr><td class="b"><tt class="varname">ffrec</tt></td><td class="s">[output,real]:</td><td>	Space-time array of the reconstructed field</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3240944"/>Optional arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">istart</tt></td><td class="s">[input,integer]:</td><td>	Index of the first component to use</td></tr><tr><td class="b"><tt class="varname">iend</tt></td><td class="s">[input,integer]:</td><td>	Index of the last component to use</td></tr></tbody></table></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sl_mssa"/>2.3. Multi-channel Singular Spectrum Analysis: <tt class="literal">sl_mssa</tt></h3></div></div><div/></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3241068"/>Usage</h4></div></div><div/></div><table bgcolor="" width="100%" align="center" border="0"><tr><td><pre class="programlisting">call <span class="b">sl_mssa</span>(<span class="b">ff</span>, <span class="b">nwindow</span>, <span class="b">nkeep</span>, steof=<span class="b">steof</span>, stpc=<span class="b">stpc</span>, ev=<span class="b">ev</span>)</pre></td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3241128"/>Description</h4></div></div><div/></div><p>
Perform a decomposition of space-time field in a set of
space-time Empirical Orthogonal Functions (EOFs) and 
time Principal components (PCs), according to a window
parameter.
		</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3241144"/>Necessary arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">ff</tt></td><td class="s">[input,real]:</td><td>			Space-time array</td></tr><tr><td class="b"><tt class="varname">nwindow</tt></td><td class="s">[input,integer]:</td><td>	Window size</td></tr><tr><td class="b"><tt class="varname">nkeep</tt></td><td class="s">[input,integer]:</td><td>		Maximum number of modes to keep in outputs</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3187902"/>Optional arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">steof</tt></td><td class="s">[output,real]:</td><td>		SpaceXwindow-mode array of EOFs</td></tr><tr><td class="b"><tt class="varname">stpc</tt></td><td class="s">[output,real]:</td><td>			Time-mode array of PCs</td></tr><tr><td class="b"><tt class="varname">ev</tt></td><td class="s">[output,real]:</td><td>			Mode array of eigen values (variances)</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3188035"/>Dependencies</h4></div></div><div/></div><p>
			<span class="b"><tt class="literal"><a href="doc_f90subs.html#sl_diasym" title="2.6. Diagonalisation of a symetric matrix: sl_diasym">sl_diasym</a></tt></span>
		</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sl_mssarec"/>2.4. Reconstruction of a set of MSSA components: <tt class="literal">sl_mssarec</tt></h3></div></div><div/></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3188077"/>Usage</h4></div></div><div/></div><table bgcolor="" width="100%" align="center" border="0"><tr><td><pre class="programlisting">call <span class="b">sl_mssarec</span>(<span class="b">steof</span>, <span class="b">stpc</span>, <span class="b">nwindow</span>, <span class="b">ffrec</span>, istart=<span class="b">istart</span>, iend=<span class="b">iend</span>)</pre></td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3188137"/>Description</h4></div></div><div/></div><p>
Same as for the reconstruction of PCA components, but for MSSA.
		</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3188149"/>Necessary arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">steof</tt></td><td class="s">[input,real]:</td><td>		SpaceXwindow-mode array of EOFs</td></tr><tr><td class="b"><tt class="varname">stpc</tt></td><td class="s">[input,real]:</td><td>		Time-mode array of PCs</td></tr><tr><td class="b"><tt class="varname">nwindow</tt></td><td class="s">[input,integer]:</td><td>	Window size</td></tr><tr><td class="b"><tt class="varname">ffrec</tt></td><td class="s">[output,real]:</td><td>		Space-time array of the reconstructed field</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3188305"/>Optional arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">istart</tt></td><td class="s">[input,integer]:</td><td>		Index of the first component to use</td></tr><tr><td class="b"><tt class="varname">iend</tt></td><td class="s">[input,integer]:</td><td>		Index of the last component to use</td></tr></tbody></table></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sl_phasecomp"/>2.5. Phase composites: <tt class="literal">sl_phasecomp</tt></h3></div></div><div/></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3246957"/>Usage</h4></div></div><div/></div><table bgcolor="" width="100%" align="center" border="0"><tr><td><pre class="programlisting">call <span class="b">sl_phasecomp</span>(<span class="b">ffrec</span>, <span class="b">np</span>, <span class="b">phases</span>, weights=<span class="b">weights</span>, offset=<span class="b">offset</span>, firstphase=<span class="b">firstphase</span>)</pre></td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247017"/>Description</h4></div></div><div/></div><p>
Performs phase composites of S-T oscillatory field.
This field is typically a reconstructed pair of MSSA modes.
Composites are evaluated according to an index defined by the
first PC of the input field and its derivative. 
Space weights can be optionally used to compute the PC.
A minimal normalized amplitude can be also used: when the
index is under value, data are not used to compute phases.
It also possible so specify the angle of the first phase
in the 360 degrees phase diagram circle: zero means the
the first phase conincides with the maximmum.
		</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247039"/>Necessary arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">ffrec</tt></td><td class="s">[input,real]:</td><td>		Space-time array</td></tr><tr><td class="b"><tt class="varname">np</tt></td><td class="s">[input,integer]:</td><td>	Number of requested phases over the 360 degrees cycle (default = 8)</td></tr><tr><td class="b"><tt class="varname">phases</tt></td><td class="s">[output,real]:</td><td> </td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247170"/>Optional arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">weights</tt></td><td class="s">[input,real]:</td><td>	Space array of weights</td></tr><tr><td class="b"><tt class="varname">offset</tt></td><td class="s">[input,real]:</td><td>		Minimal normalized amplitude of the index (default = 0.)</td></tr><tr><td class="b"><tt class="varname">firstphase</tt></td><td class="s">[input,real]:</td><td>	Value in degrees of the first phase (default = 0)</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247303"/>Dependencies</h4></div></div><div/></div><p>
			<span class="b"><tt class="literal"><a href="doc_f90subs.html#sl_pca" title="2.1. Principal Component Analysis: sl_pca">sl_pca</a></tt></span>
		</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="sl_diasym"/>2.6. Diagonalisation of a symetric matrix: <tt class="literal">sl_diasym</tt></h3></div></div><div/></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247345"/>Usage</h4></div></div><div/></div><table bgcolor="" width="100%" align="center" border="0"><tr><td><pre class="programlisting">call <span class="b">sl_diasym</span>(<span class="b">a</span>, <span class="b">eig</span>)</pre></td></tr></table></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247378"/>Description</h4></div></div><div/></div><p>
A simple interface to the ssyev diagonalisation subroutine from LAPACK.	
		</p></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247391"/>Necessary arguments</h4></div></div><div/></div><div class="informaltable"><table width="100%" border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="b"><tt class="varname">a</tt></td><td class="s">[inoutput,real]:</td><td>		Input = symetric matrix, output = EOFs</td></tr><tr><td class="b"><tt class="varname">eig</tt></td><td class="s">[output,real]:</td><td>	Eigen values</td></tr></tbody></table></div></div><div class="simplesect" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id3247500"/>Dependencies</h4></div></div><div/></div><p>
<tt class="literal">ssyev(LAPACK)</tt>
		</p></div></div></div><div xmlns="" class="generated">This document was generated   using xml/xsl and perl.</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="index.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="doc_examples.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">SpanLib - Spectral Analysis Library </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 3. Examples</td></tr></table></div></body></html>
